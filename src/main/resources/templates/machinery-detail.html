<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalles de Maquinaria - AgroRent</title>
    <link rel="stylesheet" type="text/css" th:href="@{/css/style.css}" />
</head>
<body>
    <!-- Header -->
    <header class="header">
        <nav class="nav">
            <a href="/" class="logo">üöú AgroRent</a>
            <ul class="nav-links">
                <li><a href="/">Inicio</a></li>
                <li><a href="/search">Buscar Maquinaria</a></li>
                <li sec:authorize="isAuthenticated()"><a href="/dashboard">Dashboard</a></li>
                <li sec:authorize="isAuthenticated()"><a href="/logout">Cerrar Sesi√≥n</a></li>
                <li sec:authorize="!isAuthenticated()"><a href="/login">Iniciar Sesi√≥n</a></li>
            </ul>
        </nav>
    </header>

    <main class="container">
        <div class="machinery-detail">
            <div class="back-link">
                <a href="/search">‚Üê Volver a la b√∫squeda</a>
            </div>

            <div class="machinery-header">
                <div class="machinery-image-large">
                    üöú Imagen de maquinaria
                </div>
                <div class="machinery-basic-info">
                    <h1 th:text="${machinery.name}">Nombre de la Maquinaria</h1>
                    <div class="machinery-tags">
                        <span class="tag" th:text="${machinery.type}">Tipo</span>
                        <span class="tag" th:text="${machinery.brand}">Marca</span>
                        <span class="tag" th:text="${machinery.model}">Modelo</span>
                        <span class="tag" th:text="${machinery.year}">A√±o</span>
                    </div>
                    <div class="machinery-condition">
                        <strong>Estado:</strong> <span th:text="${machinery.condition}">Condici√≥n</span>
                    </div>
                    <div class="machinery-price">
                        <h2 class="price" th:text="'$' + ${machinery.dailyRentalPrice} + '/d√≠a'">Precio por d√≠a</h2>
                    </div>
                </div>
            </div>

            <div class="machinery-details-grid">
                <div class="machinery-description">
                    <h3>Descripci√≥n</h3>
                    <p th:text="${machinery.description}">Descripci√≥n detallada de la maquinaria</p>
                    
                    <h3>Especificaciones T√©cnicas</h3>
                    <ul class="specifications-list">
                        <li th:each="spec : ${machinery.specifications}" th:text="${spec}">Especificaci√≥n</li>
                    </ul>
                    
                    <h3>Instrucciones de Operaci√≥n</h3>
                    <div class="operation-instructions">
                        <p th:text="${machinery.operationInstructions}">Instrucciones de operaci√≥n y seguridad</p>
                    </div>
                </div>

                <div class="machinery-rental-info">
                    <div class="card">
                        <h3>Informaci√≥n del Propietario</h3>
                        <div class="owner-info">
                            <p><strong>Nombre:</strong> <span th:text="${machinery.ownerName}">Nombre del propietario</span></p>
                            <p><strong>Contacto:</strong> <span th:text="${machinery.ownerContact}">Tel√©fono de contacto</span></p>
                            <p><strong>Ubicaci√≥n:</strong> <span th:text="${machinery.location}">Ubicaci√≥n de la maquinaria</span></p>
                        </div>
                        
                        <div class="availability-status" th:class="${machinery.available} ? 'available' : 'not-available'">
                            <span th:if="${machinery.available}">‚úÖ Disponible para alquiler</span>
                            <span th:unless="${machinery.available}">‚ùå No disponible actualmente</span>
                        </div>
                        
                        <div class="rental-actions" th:if="${machinery.available}">
                            <button class="btn btn-primary" onclick="contactOwner()">Contactar Propietario</button>
                            <button class="btn btn-secondary" onclick="requestQuote()">Solicitar Cotizaci√≥n</button>
                        </div>
                    </div>

                    <div class="card">
                        <h3>Detalles T√©cnicos</h3>
                        <div class="technical-details">
                            <div class="detail-row">
                                <span class="label">Marca:</span>
                                <span class="value" th:text="${machinery.brand}">Marca</span>
                            </div>
                            <div class="detail-row">
                                <span class="label">Modelo:</span>
                                <span class="value" th:text="${machinery.model}">Modelo</span>
                            </div>
                            <div class="detail-row">
                                <span class="label">A√±o:</span>
                                <span class="value" th:text="${machinery.year}">A√±o</span>
                            </div>
                            <div class="detail-row">
                                <span class="label">Estado:</span>
                                <span class="value" th:text="${machinery.condition}">Estado</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <p>&copy; 2025 AgroRent - Alquiler de Maquinaria Agr√≠cola. Todos los derechos reservados.</p>
    </footer>

    <style>
        .machinery-detail {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        .back-link {
            margin-bottom: 1rem;
        }

        .back-link a {
            color: #007bff;
            text-decoration: none;
            font-weight: 500;
        }

        .back-link a:hover {
            text-decoration: underline;
        }

        .machinery-header {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
            background: white;
            border-radius: 8px;
            padding: 2rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .machinery-image-large {
            font-size: 8rem;
            text-align: center;
            padding: 2rem;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .machinery-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin: 1rem 0;
        }

        .tag {
            background: #e9ecef;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .machinery-condition {
            margin: 1rem 0;
            font-size: 1.1rem;
        }

        .price {
            color: #28a745;
            margin: 1rem 0;
        }

        .machinery-details-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
        }

        .machinery-description {
            background: white;
            border-radius: 8px;
            padding: 2rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .specifications-list {
            list-style: none;
            padding: 0;
        }

        .specifications-list li {
            padding: 0.5rem 0;
            border-bottom: 1px solid #eee;
        }

        .specifications-list li:last-child {
            border-bottom: none;
        }

        .operation-instructions {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 4px;
            padding: 1rem;
            margin-top: 1rem;
        }

        .machinery-rental-info {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .owner-info p {
            margin: 0.5rem 0;
        }

        .availability-status {
            text-align: center;
            padding: 1rem;
            border-radius: 4px;
            font-weight: 500;
            margin: 1rem 0;
        }

        .availability-status.available {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .availability-status.not-available {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .rental-actions {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .technical-details {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem 0;
            border-bottom: 1px solid #eee;
        }

        .detail-row:last-child {
            border-bottom: none;
        }

        .label {
            font-weight: 500;
            color: #666;
        }

        .value {
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .machinery-header {
                grid-template-columns: 1fr;
            }
            
            .machinery-details-grid {
                grid-template-columns: 1fr;
            }
            
            .machinery-image-large {
                font-size: 4rem;
            }
        }
    </style>

    <script>
        function contactOwner() {
            const ownerContact = /*[[${machinery.ownerContact}]]*/ '';
            const machineryName = /*[[${machinery.name}]]*/ '';
            const message = `Hola, estoy interesado en alquilar la maquinaria: ${machineryName}. ¬øPodr√≠amos coordinar los detalles?`;
            
            // Abrir WhatsApp si el contacto parece ser un n√∫mero de tel√©fono
            if (ownerContact.includes('+56') || ownerContact.includes('9')) {
                const phone = ownerContact.replace(/\s+/g, '').replace('+56', '56');
                const whatsappUrl = `https://wa.me/${phone}?text=${encodeURIComponent(message)}`;
                window.open(whatsappUrl, '_blank');
            } else {
                alert(`Contacta al propietario: ${ownerContact}\n\nMensaje sugerido:\n${message}`);
            }
        }

        function requestQuote() {
            const machineryName = /*[[${machinery.name}]]*/ '';
            const price = /*[[${machinery.dailyRentalPrice}]]*/ '';
            alert(`Cotizaci√≥n para: ${machineryName}\nPrecio base: $${price}/d√≠a\n\nPara obtener una cotizaci√≥n personalizada, contacta directamente al propietario considerando:\n- Duraci√≥n del alquiler\n- Servicios adicionales\n- Transporte\n- Operador (si es necesario)`);
        }
    </script>
</body>
</html>