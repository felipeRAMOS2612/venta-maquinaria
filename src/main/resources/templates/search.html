<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buscar Maquinaria - AgroRent</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>
    <header class="header">
        <nav class="nav">
            <a href="/" class="logo">游뚶 AgroRent</a>
            <ul class="nav-links">
                <li><a href="/">Inicio</a></li>
                <li><a href="/search">Buscar Maquinaria</a></li>
                <li sec:authorize="isAuthenticated()"><a href="/dashboard">Dashboard</a></li>
                <li sec:authorize="isAuthenticated()"><a href="/logout">Cerrar Sesi칩n</a></li>
                <li sec:authorize="!isAuthenticated()"><a href="/login">Iniciar Sesi칩n</a></li>
            </ul>
        </nav>
    </header>

    <div class="container">
        <h1>Buscar Maquinaria Agr칤cola</h1>
        
        <form action="/search/results" method="get" class="search-form">
            <div class="form-row">
                <div class="form-group">
                    <label for="name" class="form-label">Buscar por nombre:</label>
                    <input type="text" id="name" name="name" class="form-control" placeholder="Ej: Tractor, Cosechadora, Sembradora...">
                </div>
                
                <div class="form-group">
                    <label for="type" class="form-label">Tipo de maquinaria:</label>
                    <select id="type" name="type" class="form-control">
                        <option value="">Seleccionar...</option>
                        <option value="TRACTOR">TRACTOR</option>
                        <option value="COSECHADORA">COSECHADORA</option>
                        <option value="SEMBRADORA">SEMBRADORA</option>
                        <option value="CULTIVADOR">CULTIVADOR</option>
                        <option value="ARADO">ARADO</option>
                        <option value="FUMIGADORA">FUMIGADORA</option>
                        <option value="SEGADORA">SEGADORA</option>
                        <option value="RASTRA">RASTRA</option>
                        <option value="EMPACADORA">EMPACADORA</option>
                        <option value="EXCAVADORA">EXCAVADORA</option>
                        <option value="MOTONIVELADORA">MOTONIVELADORA</option>
                        <option value="RIEGO">RIEGO</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="brand" class="form-label">Marca:</label>
                    <input type="text" id="brand" name="brand" class="form-control" placeholder="Ej: John Deere, Case, New Holland...">
                </div>
                
                <div class="form-group">
                    <label for="location" class="form-label">Ubicaci칩n:</label>
                    <input type="text" id="location" name="location" class="form-control" placeholder="Ej: Santiago, Rancagua, Temuco...">
                </div>
            </div>
            
            <button type="submit" class="btn">游댌 Buscar Maquinaria</button>
        </form>

        <!-- Mostrar maquinaria -->
        <div th:if="${machineries != null}">
            <h2 th:if="${searchPerformed != null and searchPerformed}">
                Resultados de b칰squeda (<span th:text="${#lists.size(machineries)}">0</span> m치quinas encontradas)
            </h2>
            <h2 th:unless="${searchPerformed != null and searchPerformed}">
                Toda nuestra maquinaria disponible
            </h2>

            <!-- Grid de maquinaria -->
            <div class="recipes-grid" th:if="${not #lists.isEmpty(machineries)}">
                <div th:each="machinery : ${machineries}" class="recipe-card">
                    <div class="recipe-image">
                        游뚶 Imagen de maquinaria
                    </div>
                    <div class="recipe-info">
                        <h3 class="recipe-title" th:text="${machinery.name}">Nombre de la Maquinaria</h3>
                        <p class="recipe-description" th:text="${machinery.description}">Descripci칩n de la maquinaria</p>
                        
                        <div style="margin-bottom: 1rem;">
                            <span style="background: #e9ecef; padding: 0.25rem 0.5rem; border-radius: 15px; font-size: 0.8rem; margin-right: 0.5rem;" 
                                  th:text="${machinery.type}">Tipo</span>
                            <span style="background: #e9ecef; padding: 0.25rem 0.5rem; border-radius: 15px; font-size: 0.8rem; margin-right: 0.5rem;" 
                                  th:text="${machinery.brand}">Marca</span>
                            <span style="background: #e9ecef; padding: 0.25rem 0.5rem; border-radius: 15px; font-size: 0.8rem;" 
                                  th:text="${machinery.location}">Ubicaci칩n</span>
                        </div>
                        
                        <div class="recipe-meta">
                            <span class="difficulty" th:text="${machinery.condition}">Estado</span>
                            <span class="cooking-time" th:text="'$' + ${machinery.dailyRentalPrice} + '/d칤a'">Precio diario</span>
                        </div>
                        
                        <div style="margin-top: 0.5rem; margin-bottom: 0.5rem;">
                            <small style="color: #666;">Propietario: <span th:text="${machinery.ownerName}">Due침o</span></small>
                        </div>
                        
                        <a th:href="@{/machinery/{id}(id=${machinery.id})}" class="btn" sec:authorize="isAuthenticated()">Ver Detalles</a>
                        <a href="/login" class="btn btn-secondary" sec:authorize="!isAuthenticated()">Inicia sesi칩n para ver</a>
                    </div>
                </div>
            </div>

            <!-- Mensaje si no hay resultados -->
            <div th:if="${#lists.isEmpty(machineries)}" class="card" style="text-align: center;">
                <h3>游땞 No encontramos maquinaria</h3>
                <p>Prueba con otros t칠rminos de b칰squeda o ampl칤a tus criterios.</p>
            </div>
        </div>
    </div>
</body>
</html>